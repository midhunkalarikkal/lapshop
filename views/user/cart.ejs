<!-- User navbar -->
<%-include("../userpartials/Navbar.ejs")%>

    <head>
        <style>
            /*======> Very small devices <======*/
            @media (max-width: 576px) {
                .product-text span {
                    font-size: 12px;
                }

                .add-to-cart-btn {
                    width: 5rem;
                    font-size: 12px;
                }

                .delete-btn {
                    font-size: 12px;
                }
            }

            /*======> XS/SM devices <======*/
            @media (min-width: 576px) and (max-width: 767px) {
                .product-text span {
                    font-size: 14px;
                }
            }

            /*======> MD devices <======*/
            @media (min-width: 768px) and (max-width: 991px) {
                .product-img {
                    width: 120%;
                }
            }

            /*======> LG devices <======*/
            @media (min-width: 992px) and (max-width: 1199px) {
                .product-img {
                    width: 140%;
                }
            }


            /*======> XL devices <======*/
            @media (min-width: 1200px) {
                .product-img {
                    width: 160%;
                }
            }

            .quantity-input {
                display: flex;
                align-items: center;
                justify-content: space-between;
                width: 120px;
                border: 1px solid #ccc;
                border-radius: 5px;
                overflow: hidden;
            }

            .quantity-btn {
                width: 30px;
                height: 30px;
                font-size: 18px;
                text-align: center;
                cursor: pointer;
                background-color: #f8f9fa;
                border: none;
                outline: none;
            }

            .quantity-value {
                width: 50px;
                height: 30px;
                text-align: center;
                border: none;
                outline: none;
            }
        </style>
    </head>
    <section class="view">
        <!-- Edit -->
        <div class="cart-wrap mt-5">
            <div class="container">
                <div class="row">
                    <div class="d-flex justify-content-between">
                        <h3>Your cart</h3>
                        <button class="btn btn-warning btn-sm">Go to cart</button>
                    </div>
                    <div class="col-12 col-md-8">
                        <div class="mt-4 shadow d-flex">
                            <div class="col-4 d-flex align-items-center justify-content-center">
                                <a href="/productDetail/" style="cursor: pointer;">
                                    <img src="https://images-eu.ssl-images-amazon.com/images/I/71nAEVpqXuL._AC_UL100_SR100,100_.jpg"
                                        alt="" class=" product-img">
                                </a>
                            </div>
                            <div class="col-8 mx-2 p-3">
                                <p class="mt-2"><span class="product-brand">Product brand</span>
                                    <br>
                                    <span class="product-name">Product name</span>
                                    <br>
                                    <span class="product-desc">Anmol PERFUME Automatic Air Freshener Refill Machine Pack
                                        for home, bathroom, office, School hotel and restaurants|300ml (Mineral)</span>
                                    <br>
                                    <span class="product-stock">In stock</span>
                                    <br>
                                    <span>Item added on <span class="item-added-date">Date</span></span>
                                </p>
                                <div class="buttons mb-3 d-flex">
                                    <div class="quantity-input">
                                        <button class="quantity-btn" onclick="decreaseQuantity()">-</button>
                                        <input type="text" class="quantity-value" value="1">
                                        <button class="quantity-btn" onclick="increaseQuantity()">+</button>
                                    </div>
                                    <button class="btn btn-danger btn-sm mx-2"><i class="fa fa-trash"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-10 col-md-4">
                        <div class="subtotal mt-4 shadow d-flex flex-column p-3">
                            <div class="head text-center">
                                <p class="text-success">Part of your order qualifies for FREE Delivery. Choose FREE Delivery option at checkout.</p>
                            </div>
                            <div class="details">
                                <h6>No of items <span> 10</span></h6>
                                <h5>Subtotal <span>	â‚¹ 10000</span></h5>
                            </div>
                            <div class="button mt-3">
                                <button class="btn btn-warning w-100">Proceed to checkout</button>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-info text-center mt-4" role="alert">Your wishlist is empty.</div>
                </div>
            </div>
        </div>
        <!-- Edit -->
    </section>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script>
        function deleteProduct(delbtn) {
            const productId = delbtn.getAttribute("data-prod-id");
            console.log("productId :", productId)

            console.log("data :", productId)
            fetch('/deleteProductFromWishlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ productId: productId })
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log("Product deletion response:", data);
                    Swal.fire({
                        title: "Success",
                        text: data.message,
                        icon: "success",
                        timer: 2000,
                        timerProgressBar: true,
                        showConfirmButton: false
                    }).then(() => {
                        location.reload();
                    });
                })
                .catch(error => {
                    console.error('Error deleting product:', error);
                    if (error.message.includes('404')) {
                        Swal.fire({
                            title: "Error",
                            text: error.message,
                            icon: "error",
                            timer: 2000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        });
                    } else if (error.message.includes('400')) {
                        Swal.fire({
                            title: "Error",
                            text: error.message,
                            icon: "error",
                            timer: 2000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        });
                    } else {
                        Swal.fire({
                            title: "Error",
                            text: "Internal server error.",
                            icon: "error",
                            timer: 2000,
                            timerProgressBar: true,
                            showConfirmButton: false
                        });
                    }
                });
        }

        //Function for the quantity button
        function increaseQuantity() {
            var input = document.querySelector('.quantity-value');
            var value = parseInt(input.value);
            input.value = value + 1;
        }

        function decreaseQuantity() {
            var input = document.querySelector('.quantity-value');
            var value = parseInt(input.value);
            if (value > 1) {
                input.value = value - 1;
            }
        }
    </script>

    <!-- User footer -->
    <%-include("../userpartials/Footer.ejs")%>